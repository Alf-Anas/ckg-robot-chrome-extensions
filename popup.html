<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>CKG Robot</title>
        <link href="lib/bootstrap.min.css" rel="stylesheet" />
        <script src="lib/bootstrap.bundle.min.js"></script>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body class="p-3 position-relative">
        <div style="min-height: 80px">
            <h4 class="text-primary">🤖 CKG Robot</h4>
            <p class="text-muted hide-on-minimized">
                Upload file Excel dan jalankan robot!
            </p>
        </div>

        <div
            style="
                position: absolute;
                top: 10px;
                right: 10px;
                text-align: center;
            "
        >
            <a
                href="https://trakteer.id/alf-anas"
                target="_blank"
                style="display: inline-block; margin-bottom: 5px"
            >
                <img
                    src="https://cdn.trakteer.id/images/embed/trbtn-red-1.png"
                    alt="Trakteer Saya"
                    style="max-height: 50px; max-width: 181px"
                    loading="lazy"
                />
            </a>
            <div style="font-size: 13px; color: #555">
                Created by <strong>Alf-Anas</strong> |
                <a
                    href="https://geoit.dev"
                    target="_blank"
                    style="color: #007bff; text-decoration: none"
                >
                    geoit.dev
                </a>
            </div>
        </div>

        <div class="mb-3 d-flex gap-2 align-items-center hide-on-minimized">
            <input
                class="form-control flex-grow-1"
                type="file"
                id="excelFile"
                accept=".xlsx, .xls"
            />
            <button id="convertBtn" class="btn btn-primary text-nowrap">
                Load Data
            </button>
        </div>
        <hr class="hide-on-minimized" />
        <pre
            id="output"
            class="bg-light p-2 rounded small hide-on-minimized"
        ></pre>

        <div class="accordion my-2 hide-on-minimized" id="accordionExample">
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingOne">
                    <button
                        class="accordion-button"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseOne"
                        aria-controls="collapseOne"
                    >
                        Setting
                    </button>
                </h2>
                <div
                    id="collapseOne"
                    class="accordion-collapse collapse"
                    aria-labelledby="headingOne"
                    aria-expanded="true"
                    data-bs-parent="#accordionExample"
                >
                    <div class="accordion-body show">
                        <h5>
                            Data default akan digunakan ketika data di excel
                            kosong!
                        </h5>
                        <form>
                            <div class="row g-3">
                                <!-- Kolom Kiri -->
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label for="tanggal" class="form-label"
                                            >Tanggal Pemeriksaan</label
                                        >
                                        <input
                                            type="number"
                                            id="tanggal_pemeriksaan"
                                            class="form-control"
                                            min="1"
                                            max="31"
                                            placeholder="1-31"
                                        />
                                    </div>

                                    <div class="mb-3">
                                        <label for="wa" class="form-label"
                                            >Default No. WA</label
                                        >
                                        <div class="input-group mb-3">
                                            <span
                                                class="input-group-text"
                                                id="basic-addon1"
                                                >62</span
                                            >
                                            <input
                                                type="number"
                                                id="no_wa"
                                                class="form-control"
                                            />
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="alamat" class="form-label"
                                            >Default Alamat</label
                                        >
                                        <textarea
                                            id="alamat"
                                            class="form-control"
                                            rows="3"
                                        ></textarea>
                                    </div>
                                </div>

                                <!-- Kolom Kanan -->
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label for="provinsi" class="form-label"
                                            >Provinsi</label
                                        >
                                        <input
                                            type="text"
                                            id="provinsi"
                                            class="form-control"
                                        />
                                    </div>

                                    <div class="mb-3">
                                        <label for="kabkota" class="form-label"
                                            >Kabupaten / Kota</label
                                        >
                                        <input
                                            type="text"
                                            id="kabkota"
                                            class="form-control"
                                        />
                                    </div>

                                    <div class="mb-3">
                                        <label
                                            for="kecamatan"
                                            class="form-label"
                                            >Kecamatan</label
                                        >

                                        <input
                                            type="text"
                                            id="kecamatan"
                                            class="form-control"
                                        />
                                    </div>

                                    <div class="mb-3">
                                        <label for="keldesa" class="form-label"
                                            >Kelurahan / Desa</label
                                        >

                                        <input
                                            type="text"
                                            id="keldesa"
                                            class="form-control"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div class="row g-3">
                                <!-- Kolom Kiri -->
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label
                                            for="berat_badan"
                                            class="form-label"
                                            >Default Berat Badan</label
                                        >
                                        <input
                                            type="number"
                                            id="berat_badan"
                                            class="form-control"
                                        />
                                    </div>

                                    <div class="mb-3">
                                        <label
                                            for="tinggi_badan"
                                            class="form-label"
                                            >Default Tinggi Badan</label
                                        >

                                        <input
                                            type="number"
                                            id="tinggi_badan"
                                            class="form-control"
                                        />
                                    </div>

                                    <div class="mb-3">
                                        <label
                                            for="lingkar_perut"
                                            class="form-label"
                                            >Default Lingkar Perut</label
                                        >

                                        <input
                                            type="number"
                                            id="lingkar_perut"
                                            class="form-control"
                                        />
                                    </div>
                                </div>

                                <!-- Kolom Kanan -->
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label
                                            for="td_sistol"
                                            class="form-label"
                                            >Default Tekanan Darah
                                            Sistolik</label
                                        >
                                        <input
                                            type="number"
                                            id="td_sistol"
                                            class="form-control"
                                        />
                                    </div>

                                    <div class="mb-3">
                                        <label
                                            for="td_diastol"
                                            class="form-label"
                                            >Default Tekanan Darah
                                            Diastol</label
                                        >

                                        <input
                                            type="number"
                                            id="td_diastol"
                                            class="form-control"
                                        />
                                    </div>

                                    <div class="mb-3">
                                        <label
                                            for="pemeriksaan_gula"
                                            class="form-label"
                                            >Default Gula Darah Sewaktu
                                            (GDS)</label
                                        >

                                        <input
                                            type="number"
                                            id="pemeriksaan_gula"
                                            class="form-control"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div class="mt-3">
                                <button
                                    type="button"
                                    id="btnSaveDefault"
                                    class="btn btn-primary"
                                >
                                    Simpan
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div
            class="table-responsive hide-on-minimized"
            style="max-height: 400px; overflow-y: auto; overflow-x: auto"
        >
            <table
                class="table table-bordered table-striped table-sm table-compact"
            >
                <thead class="table-dark">
                    <tr>
                        <th>No</th>
                        <th>NIK</th>
                        <th>Nama</th>
                        <th>Tgl Lahir</th>
                        <th>Jenis Kelamin</th>
                        <th>Status Input</th>
                        <th>Keterangan</th>
                        <th>Daftar</th>
                        <th>Hadir</th>
                        <th>Pemeriksaan</th>
                        <th>Rapor</th>
                    </tr>
                </thead>
                <tbody id="dataBody">
                    <!-- Data akan dimasukkan lewat JS -->
                </tbody>
            </table>
        </div>

        <hr class="hide-on-minimized" />
        <div class="d-flex gap-2 mt-4 hide-on-minimized">
            <button id="runBtn" class="btn btn-success w-100" disabled>
                Jalankan Pendaftaran & Kehadiran
            </button>
            <button id="runPelayanan" class="btn btn-primary w-100" disabled>
                Jalankan Pemeriksaan
            </button>
        </div>
        <hr class="hide-on-minimized" />
        <div
            id="parent-text-message"
            class="alert alert-warning d-flex align-items-center d-none"
            role="alert"
        >
            <svg
                class="bi flex-shrink-0 me-2"
                width="24"
                height="24"
                role="img"
                aria-label="Warning:"
            >
                <use xlink:href="#exclamation-triangle-fill" />
            </svg>
            <div id="text-message"></div>
        </div>
        <div
            id="loading-spinner"
            class="text-center mx-auto w-100"
            style="display: none"
        >
            <p class="text-center">
                ⚠️ Jangan tutup atau close window ini, proses sedang berjalan!
            </p>
            <div class="spinner-grow text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-secondary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-success" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-danger" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-warning" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-info" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-light" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-dark" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
        <button id="openDashboard" class="btn btn-warning w-100 mt-2 mb-4">
            Lihat Dashboard
        </button>
        <button id="minimize" class="btn btn-secondary btn-sm w-100 mt-2 mb-4">
            Kecilkan/Besarkan Tampilan
        </button>

        <script src="lib/xlsx.full.min.js"></script>
        <script src="helper.js"></script>
        <script src="scripts/common.js"></script>
        <script src="scripts/load-data.js"></script>
        <script src="scripts/run-robot.js"></script>
    </body>
</html>
